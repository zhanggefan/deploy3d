#pragma once
#include "mm/config_simt.h"
#include "mm/config_tensorop.h"

#include "common/launch.cuh"
#include "common/refnd.h"

using utils::GPU;
using utils::launch::CUDA_NUM_THREADS;
using utils::launch::getBlocks;
using utils::launch::KernelLoopX;
using utils::nd::Ref1D;
using utils::nd::Ref2D;
using utils::nd::Ref3D;

namespace spconv {
namespace kernel {
template <class T> __global__ void biasInit(Ref2D<T> outFeats, const Ref1D<const T> initVec) {
  size_t numOuts = outFeats.size(0);
  size_t numFeats = outFeats.size(1);
  size_t numOutElem = numOuts * numFeats;
  for (size_t ix : KernelLoopX<size_t>(numOutElem)) {
    if (ix < numOutElem) outFeats[ix] = initVec[ix % numFeats];
  }
}
}  // namespace kernel

namespace func {

using utils::GPU;
using utils::nd::Ref1D;
using utils::nd::Ref2D;
using utils::nd::Ref3D;

template <typename Config>
bool indexedSpConv(const GPU& d,
                   Ref2D<typename Config::Element>& outFeats,
                   const Ref2D<const typename Config::Element>& inFeats,
                   const Ref3D<const typename Config::Element>& filters,
                   const Ref1D<const typename Config::Element>& bias,
                   const Ref1D<const int32_t>& gatherIn,
                   const Ref1D<const int32_t>& scatterOut,
                   const Ref1D<const int32_t>& kernelOffset,
                   const int32_t* numIndexPtr) {
  using Element = typename Config::Element;
  if (!Config::can_implement(inFeats.size(1), outFeats.size(1), (Element*)inFeats.data(), (Element*)filters.data(),
                             (Element*)outFeats.data()))
    return false;

  ssize_t numThreads;
  if (bias.empty()) {
    cudaMemsetAsync(outFeats.data(), 0, outFeats.numel() * sizeof(Element), d.getStream());
  } else {
    numThreads = (outFeats.numel() + 3) / 4;
    kernel::biasInit<Element><<<getBlocks(numThreads), CUDA_NUM_THREADS, 0, d.getStream()>>>(outFeats, bias);
  }
  ssize_t numIndicesMax = gatherIn.numel();
  ssize_t numFeatsIn = inFeats.size(1);
  ssize_t numFeatsOut = filters.size(2);
  typename Config::Params params(numIndicesMax, numFeatsIn, numFeatsOut, (typename Config::Element*)inFeats.data(),
                                 (typename Config::Element*)filters.data(), (typename Config::Element*)outFeats.data(),
                                 gatherIn.data(), kernelOffset.data(), scatterOut.data(), numIndexPtr);

  constexpr int smem_size = int(sizeof(typename Config::SharedStorage));
  if (smem_size >= (48 << 10)) {
    auto result = cudaFuncSetAttribute(cutlass::Kernel<Config>, cudaFuncAttributeMaxDynamicSharedMemorySize, smem_size);
    if (result != cudaSuccess) { std::cout << cudaGetErrorString(result) << std::endl; }
  }
  cutlass::Kernel<Config><<<params.grid_size(), params.block_size(), smem_size, d.getStream()>>>(params);
  return true;
}

using cutlass::half_t;
using cutlass::arch::Sm75;
using cutlass::arch::Sm80;
using spconv::mm::Simt;
using spconv::mm::TensorOp;

template <typename... Configs> struct IndexedSpConvDispatcher {
  using Config = std::tuple_element_t<0, std::tuple<Configs...>>;
  using Element = typename Config::Element;
  using OpsFunctor = bool (*)(const GPU& d,
                              Ref2D<Element>& outFeats,
                              const Ref2D<const Element>& inFeats,
                              const Ref3D<const Element>& filters,
                              const Ref1D<const Element>& bias,
                              const Ref1D<const int32_t>& gatherIn,
                              const Ref1D<const int32_t>& scatterOut,
                              const Ref1D<const int32_t>& kernelOffset,
                              const int32_t* numIndexPtr);
  static constexpr int numConfigs = sizeof...(Configs);
  OpsFunctor ops[numConfigs] = {indexedSpConv<Configs>...};
  OpsFunctor& operator[](int i) {
    if (i < numConfigs && i >= 0) return ops[i];
    return ops[0];
  }
};

using IndexedSpConvDispatcherHalf = IndexedSpConvDispatcher<Simt<half_t, 16, 128, 8, 8, 64, 8, Sm75>,
                                                            Simt<half_t, 32, 32, 16, 8, 16, 16, Sm75>,
                                                            Simt<half_t, 64, 32, 8, 32, 8, 8, Sm75>,
                                                            Simt<half_t, 32, 128, 8, 8, 64, 8, Sm75>,
                                                            Simt<half_t, 16, 32, 16, 8, 16, 16, Sm75>,
                                                            Simt<half_t, 32, 32, 16, 16, 16, 16, Sm75>,
                                                            Simt<half_t, 32, 64, 16, 16, 8, 16, Sm75>,
                                                            Simt<half_t, 16, 64, 16, 16, 32, 16, Sm75>,
                                                            Simt<half_t, 32, 64, 16, 8, 16, 16, Sm75>,
                                                            Simt<half_t, 16, 32, 8, 16, 8, 8, Sm75>,
                                                            Simt<half_t, 64, 64, 8, 64, 8, 8, Sm75>,
                                                            Simt<half_t, 16, 128, 16, 16, 64, 16, Sm75>,
                                                            Simt<half_t, 16, 64, 8, 8, 64, 8, Sm75>,
                                                            Simt<half_t, 32, 128, 8, 16, 128, 8, Sm75>,
                                                            Simt<half_t, 16, 64, 16, 8, 64, 16, Sm75>,
                                                            Simt<half_t, 32, 64, 8, 8, 64, 8, Sm75>,
                                                            Simt<half_t, 8, 128, 16, 8, 64, 16, Sm75>,
                                                            Simt<half_t, 64, 64, 8, 16, 32, 8, Sm75>,
                                                            Simt<half_t, 32, 32, 8, 32, 8, 8, Sm75>,
                                                            Simt<half_t, 16, 128, 16, 8, 32, 16, Sm75>,
                                                            Simt<half_t, 16, 128, 8, 16, 128, 8, Sm75>,
                                                            Simt<half_t, 16, 32, 16, 16, 16, 16, Sm75>,
                                                            Simt<half_t, 32, 32, 16, 32, 16, 16, Sm75>,
                                                            Simt<half_t, 32, 64, 8, 32, 16, 8, Sm75>,
                                                            Simt<half_t, 32, 64, 16, 16, 64, 16, Sm75>,
                                                            Simt<half_t, 16, 128, 8, 8, 128, 8, Sm75>,
                                                            Simt<half_t, 16, 64, 16, 8, 16, 16, Sm75>,
                                                            Simt<half_t, 32, 128, 8, 8, 128, 8, Sm75>,
                                                            Simt<half_t, 64, 32, 8, 32, 16, 8, Sm75>,
                                                            Simt<half_t, 32, 128, 16, 16, 128, 16, Sm75>,
                                                            Simt<half_t, 32, 128, 16, 8, 64, 16, Sm75>,
                                                            Simt<half_t, 64, 32, 16, 16, 8, 16, Sm75>,
                                                            Simt<half_t, 16, 32, 8, 16, 16, 8, Sm75>,
                                                            Simt<half_t, 64, 64, 8, 64, 16, 8, Sm75>,
                                                            Simt<half_t, 64, 32, 16, 32, 8, 16, Sm75>,
                                                            Simt<half_t, 32, 64, 8, 16, 16, 8, Sm75>,
                                                            Simt<half_t, 32, 64, 8, 16, 32, 8, Sm75>,
                                                            Simt<half_t, 64, 64, 8, 16, 64, 8, Sm75>,
                                                            Simt<half_t, 8, 64, 16, 8, 16, 16, Sm75>,
                                                            Simt<half_t, 32, 32, 8, 32, 16, 8, Sm75>,
                                                            Simt<half_t, 16, 128, 16, 8, 64, 16, Sm75>,
                                                            Simt<half_t, 64, 64, 16, 16, 64, 16, Sm75>,
                                                            Simt<half_t, 64, 64, 16, 16, 8, 16, Sm75>,
                                                            Simt<half_t, 32, 32, 8, 8, 16, 8, Sm75>,
                                                            Simt<half_t, 32, 64, 8, 32, 32, 8, Sm75>,
                                                            Simt<half_t, 16, 32, 8, 8, 16, 8, Sm75>,
                                                            Simt<half_t, 8, 32, 8, 8, 16, 8, Sm75>,
                                                            Simt<half_t, 16, 128, 8, 16, 32, 8, Sm75>,
                                                            Simt<half_t, 32, 32, 16, 8, 32, 16, Sm75>,
                                                            Simt<half_t, 64, 32, 8, 32, 32, 8, Sm75>,
                                                            Simt<half_t, 16, 32, 16, 8, 32, 16, Sm75>,
                                                            Simt<half_t, 32, 64, 16, 16, 16, 16, Sm75>,
                                                            Simt<half_t, 16, 64, 16, 16, 64, 16, Sm75>,
                                                            Simt<half_t, 32, 64, 16, 8, 32, 16, Sm75>,
                                                            Simt<half_t, 16, 32, 8, 16, 32, 8, Sm75>,
                                                            Simt<half_t, 16, 128, 16, 16, 128, 16, Sm75>,
                                                            Simt<half_t, 16, 64, 8, 16, 16, 8, Sm75>,
                                                            Simt<half_t, 32, 128, 8, 32, 16, 8, Sm75>,
                                                            Simt<half_t, 32, 128, 8, 32, 32, 8, Sm75>,
                                                            Simt<half_t, 8, 32, 16, 8, 8, 16, Sm75>,
                                                            Simt<half_t, 32, 64, 8, 16, 64, 8, Sm75>,
                                                            Simt<half_t, 8, 128, 16, 8, 128, 16, Sm75>,
                                                            Simt<half_t, 64, 64, 8, 32, 8, 8, Sm75>,
                                                            Simt<half_t, 64, 64, 8, 8, 32, 8, Sm75>,
                                                            Simt<half_t, 32, 32, 8, 32, 32, 8, Sm75>,
                                                            Simt<half_t, 8, 64, 8, 8, 32, 8, Sm75>,
                                                            Simt<half_t, 64, 32, 8, 8, 32, 8, Sm75>,
                                                            Simt<half_t, 32, 32, 8, 8, 32, 8, Sm75>,
                                                            Simt<half_t, 16, 32, 16, 16, 32, 16, Sm75>,
                                                            Simt<half_t, 32, 64, 8, 32, 64, 8, Sm75>,
                                                            Simt<half_t, 64, 32, 16, 8, 16, 16, Sm75>,
                                                            Simt<half_t, 64, 64, 16, 8, 16, 16, Sm75>,
                                                            Simt<half_t, 16, 128, 8, 16, 64, 8, Sm75>,
                                                            Simt<half_t, 32, 32, 16, 16, 8, 16, Sm75>,
                                                            Simt<half_t, 64, 32, 8, 64, 8, 8, Sm75>,
                                                            Simt<half_t, 32, 32, 16, 16, 32, 16, Sm75>,
                                                            Simt<half_t, 32, 128, 16, 8, 128, 16, Sm75>,
                                                            Simt<half_t, 64, 32, 16, 16, 16, 16, Sm75>,
                                                            Simt<half_t, 32, 64, 16, 8, 64, 16, Sm75>,
                                                            Simt<half_t, 64, 64, 8, 64, 32, 8, Sm75>,
                                                            Simt<half_t, 16, 32, 16, 8, 8, 16, Sm75>,
                                                            Simt<half_t, 64, 32, 16, 32, 16, 16, Sm75>,
                                                            Simt<half_t, 16, 64, 8, 16, 32, 8, Sm75>,
                                                            Simt<half_t, 16, 64, 16, 16, 8, 16, Sm75>,
                                                            Simt<half_t, 32, 128, 8, 32, 64, 8, Sm75>,
                                                            Simt<half_t, 32, 64, 8, 32, 8, 8, Sm75>,
                                                            Simt<half_t, 64, 64, 8, 32, 16, 8, Sm75>,
                                                            Simt<half_t, 8, 64, 16, 8, 32, 16, Sm75>,
                                                            Simt<half_t, 64, 64, 8, 8, 64, 8, Sm75>,
                                                            Simt<half_t, 16, 128, 16, 8, 128, 16, Sm75>,
                                                            Simt<half_t, 8, 128, 8, 8, 64, 8, Sm75>,
                                                            Simt<half_t, 8, 64, 8, 8, 64, 8, Sm75>,
                                                            Simt<half_t, 64, 64, 16, 32, 8, 16, Sm75>,
                                                            Simt<half_t, 64, 64, 16, 16, 16, 16, Sm75>,
                                                            Simt<half_t, 32, 32, 8, 16, 8, 8, Sm75>,
                                                            Simt<half_t, 32, 64, 16, 32, 8, 16, Sm75>,
                                                            Simt<half_t, 64, 128, 8, 32, 32, 8, Sm75>,
                                                            Simt<half_t, 64, 128, 8, 16, 32, 8, Sm75>,
                                                            Simt<half_t, 64, 128, 8, 64, 64, 8, Sm75>,
                                                            Simt<half_t, 16, 32, 8, 8, 32, 8, Sm75>,
                                                            Simt<half_t, 8, 32, 8, 8, 32, 8, Sm75>,
                                                            Simt<half_t, 8, 128, 16, 8, 32, 16, Sm75>,
                                                            Simt<half_t, 16, 64, 16, 8, 32, 16, Sm75>,
                                                            Simt<half_t, 128, 128, 8, 128, 128, 8, Sm75>,
                                                            Simt<half_t, 64, 32, 8, 64, 16, 8, Sm75>,
                                                            Simt<half_t, 32, 128, 16, 32, 16, 16, Sm75>,
                                                            Simt<half_t, 16, 32, 16, 16, 8, 16, Sm75>,
                                                            Simt<half_t, 32, 64, 16, 16, 32, 16, Sm75>,
                                                            Simt<half_t, 32, 128, 16, 16, 32, 16, Sm75>,
                                                            Simt<half_t, 64, 64, 8, 64, 64, 8, Sm75>,
                                                            Simt<half_t, 32, 128, 8, 32, 128, 8, Sm75>,
                                                            Simt<half_t, 8, 32, 16, 8, 16, 16, Sm75>,
                                                            Simt<half_t, 64, 64, 8, 32, 32, 8, Sm75>,
                                                            Simt<half_t, 32, 32, 16, 8, 8, 16, Sm75>,
                                                            Simt<half_t, 8, 128, 8, 8, 128, 8, Sm75>,
                                                            Simt<half_t, 16, 128, 16, 16, 32, 16, Sm75>,
                                                            Simt<half_t, 64, 32, 8, 16, 16, 8, Sm75>,
                                                            Simt<half_t, 32, 32, 8, 16, 16, 8, Sm75>,
                                                            Simt<half_t, 64, 128, 8, 32, 64, 8, Sm75>,
                                                            Simt<half_t, 64, 128, 8, 16, 64, 8, Sm75>,
                                                            Simt<half_t, 64, 128, 8, 64, 128, 8, Sm75>,
                                                            Simt<half_t, 128, 32, 8, 64, 8, 8, Sm75>,
                                                            Simt<half_t, 64, 128, 16, 8, 32, 16, Sm75>,
                                                            Simt<half_t, 64, 32, 16, 8, 32, 16, Sm75>,
                                                            Simt<half_t, 64, 64, 16, 8, 32, 16, Sm75>,
                                                            Simt<half_t, 32, 128, 8, 16, 32, 8, Sm75>,
                                                            Simt<half_t, 64, 32, 8, 64, 32, 8, Sm75>,
                                                            Simt<half_t, 32, 32, 16, 32, 8, 16, Sm75>,
                                                            Simt<half_t, 64, 32, 16, 16, 32, 16, Sm75>,
                                                            Simt<half_t, 16, 64, 8, 16, 64, 8, Sm75>,
                                                            Simt<half_t, 128, 64, 8, 16, 32, 8, Sm75>,
                                                            Simt<half_t, 16, 64, 16, 16, 16, 16, Sm75>,
                                                            Simt<half_t, 64, 64, 8, 32, 64, 8, Sm75>,
                                                            Simt<half_t, 8, 64, 16, 8, 64, 16, Sm75>,
                                                            Simt<half_t, 64, 64, 8, 16, 16, 8, Sm75>,
                                                            Simt<half_t, 64, 64, 16, 32, 16, 16, Sm75>,
                                                            Simt<half_t, 64, 64, 16, 16, 32, 16, Sm75>,
                                                            Simt<half_t, 64, 32, 8, 16, 32, 8, Sm75>,
                                                            Simt<half_t, 32, 32, 8, 16, 32, 8, Sm75>,
                                                            Simt<half_t, 32, 64, 8, 8, 32, 8, Sm75>,
                                                            Simt<half_t, 16, 64, 8, 8, 32, 8, Sm75>,
                                                            Simt<half_t, 32, 64, 16, 32, 16, 16, Sm75>,
                                                            Simt<half_t, 64, 128, 8, 32, 128, 8, Sm75>,
                                                            Simt<half_t, 64, 128, 8, 16, 128, 8, Sm75>,
                                                            Simt<half_t, 64, 128, 16, 32, 16, 16, Sm75>,
                                                            Simt<half_t, 64, 128, 16, 16, 64, 16, Sm75>,
                                                            Simt<half_t, 128, 32, 8, 64, 16, 8, Sm75>,
                                                            Simt<half_t, 128, 128, 8, 64, 64, 8, Sm75>,
                                                            Simt<half_t, 32, 128, 8, 16, 64, 8, Sm75>,
                                                            Simt<half_t, 128, 128, 16, 32, 16, 16, Sm75>,
                                                            Simt<half_t, 128, 128, 8, 32, 32, 8, Sm75>,
                                                            Simt<half_t, 32, 128, 16, 16, 64, 16, Sm75>,
                                                            Simt<half_t, 128, 64, 8, 128, 32, 8, Sm75>,
                                                            Simt<half_t, 128, 64, 8, 16, 64, 8, Sm75>,
                                                            Simt<half_t, 8, 32, 16, 8, 32, 16, Sm75>,
                                                            Simt<half_t, 128, 64, 8, 64, 8, 8, Sm75>,
                                                            Simt<half_t, 32, 128, 16, 8, 32, 16, Sm75>,
                                                            Simt<half_t, 128, 32, 8, 64, 32, 8, Sm75>,
                                                            Simt<half_t, 64, 128, 16, 8, 64, 16, Sm75>,
                                                            Simt<half_t, 128, 128, 8, 16, 32, 8, Sm75>,
                                                            Simt<half_t, 128, 128, 8, 64, 128, 8, Sm75>,
                                                            Simt<half_t, 64, 64, 16, 8, 64, 16, Sm75>,
                                                            Simt<half_t, 128, 128, 16, 16, 64, 16, Sm75>,
                                                            Simt<half_t, 128, 128, 8, 32, 64, 8, Sm75>,
                                                            Simt<half_t, 128, 64, 8, 128, 64, 8, Sm75>,
                                                            Simt<half_t, 128, 64, 8, 64, 16, 8, Sm75>,
                                                            Simt<half_t, 128, 64, 16, 8, 32, 16, Sm75>,
                                                            Simt<half_t, 64, 128, 8, 8, 64, 8, Sm75>,
                                                            Simt<half_t, 64, 128, 8, 64, 16, 8, Sm75>,
                                                            Simt<half_t, 64, 128, 8, 32, 16, 8, Sm75>,
                                                            Simt<half_t, 64, 128, 16, 16, 128, 16, Sm75>,
                                                            Simt<half_t, 128, 32, 8, 128, 8, 8, Sm75>,
                                                            Simt<half_t, 128, 64, 8, 8, 64, 8, Sm75>,
                                                            Simt<half_t, 128, 128, 8, 16, 64, 8, Sm75>,
                                                            Simt<half_t, 128, 128, 8, 32, 128, 8, Sm75>,
                                                            Simt<half_t, 128, 64, 8, 32, 16, 8, Sm75>,
                                                            Simt<half_t, 128, 64, 8, 64, 32, 8, Sm75>,
                                                            Simt<half_t, 128, 64, 16, 32, 8, 16, Sm75>,
                                                            Simt<half_t, 64, 128, 8, 8, 128, 8, Sm75>,
                                                            Simt<half_t, 64, 128, 8, 64, 32, 8, Sm75>,
                                                            Simt<half_t, 128, 32, 8, 128, 16, 8, Sm75>,
                                                            Simt<half_t, 64, 128, 16, 8, 128, 16, Sm75>,
                                                            Simt<half_t, 128, 128, 8, 16, 128, 8, Sm75>,
                                                            Simt<half_t, 128, 128, 8, 128, 16, 8, Sm75>,
                                                            Simt<half_t, 128, 128, 16, 16, 128, 16, Sm75>,
                                                            Simt<half_t, 128, 64, 8, 32, 32, 8, Sm75>,
                                                            Simt<half_t, 128, 64, 8, 64, 64, 8, Sm75>,
                                                            Simt<half_t, 128, 64, 16, 8, 64, 16, Sm75>,
                                                            Simt<half_t, 128, 32, 8, 128, 32, 8, Sm75>,
                                                            Simt<half_t, 128, 128, 8, 128, 32, 8, Sm75>,
                                                            Simt<half_t, 128, 128, 16, 8, 64, 16, Sm75>,
                                                            Simt<half_t, 128, 128, 16, 16, 32, 16, Sm75>,
                                                            Simt<half_t, 128, 128, 8, 64, 16, 8, Sm75>,
                                                            Simt<half_t, 128, 64, 8, 32, 64, 8, Sm75>,
                                                            Simt<half_t, 128, 64, 8, 128, 8, 8, Sm75>,
                                                            Simt<half_t, 128, 64, 16, 32, 16, 16, Sm75>,
                                                            Simt<half_t, 64, 128, 16, 16, 32, 16, Sm75>,
                                                            Simt<half_t, 128, 32, 16, 32, 8, 16, Sm75>,
                                                            Simt<half_t, 128, 128, 8, 32, 16, 8, Sm75>,
                                                            Simt<half_t, 128, 128, 8, 128, 64, 8, Sm75>,
                                                            Simt<half_t, 128, 128, 8, 64, 32, 8, Sm75>,
                                                            Simt<half_t, 128, 64, 8, 128, 16, 8, Sm75>,
                                                            Simt<half_t, 128, 64, 16, 16, 16, 16, Sm75>,
                                                            Simt<half_t, 128, 32, 16, 16, 16, 16, Sm75>,
                                                            Simt<half_t, 128, 128, 16, 8, 128, 16, Sm75>,
                                                            Simt<half_t, 128, 32, 8, 16, 32, 8, Sm75>,
                                                            Simt<half_t, 128, 32, 16, 32, 16, 16, Sm75>,
                                                            Simt<half_t, 128, 64, 16, 16, 32, 16, Sm75>,
                                                            Simt<half_t, 128, 32, 16, 16, 32, 16, Sm75>,
                                                            Simt<half_t, 128, 128, 8, 8, 64, 8, Sm75>,
                                                            Simt<half_t, 128, 32, 8, 32, 16, 8, Sm75>,
                                                            Simt<half_t, 128, 32, 16, 8, 32, 16, Sm75>,
                                                            Simt<half_t, 128, 128, 8, 8, 128, 8, Sm75>,
                                                            Simt<half_t, 128, 32, 8, 32, 32, 8, Sm75>,
                                                            Simt<half_t, 128, 64, 16, 16, 64, 16, Sm75>,
                                                            TensorOp<half_t, 32, 128, 32, 32, 128, 32, Sm75>,
                                                            TensorOp<half_t, 16, 64, 32, 16, 64, 32, Sm75>,
                                                            TensorOp<half_t, 32, 128, 16, 16, 128, 16, Sm75>,
                                                            TensorOp<half_t, 8, 128, 32, 8, 128, 32, Sm75>,
                                                            TensorOp<half_t, 16, 128, 32, 8, 128, 32, Sm75>,
                                                            TensorOp<half_t, 16, 128, 32, 16, 64, 32, Sm75>,
                                                            TensorOp<half_t, 32, 128, 32, 8, 128, 32, Sm75>,
                                                            TensorOp<half_t, 32, 64, 16, 32, 32, 16, Sm75>,
                                                            TensorOp<half_t, 8, 64, 32, 8, 64, 32, Sm75>,
                                                            TensorOp<half_t, 32, 128, 32, 16, 64, 32, Sm75>,
                                                            TensorOp<half_t, 32, 128, 32, 32, 32, 32, Sm75>,
                                                            TensorOp<half_t, 32, 64, 32, 16, 32, 32, Sm75>,
                                                            TensorOp<half_t, 16, 128, 32, 16, 128, 16, Sm75>,
                                                            TensorOp<half_t, 32, 64, 32, 32, 32, 32, Sm75>,
                                                            TensorOp<half_t, 32, 64, 32, 8, 64, 32, Sm75>,
                                                            TensorOp<half_t, 32, 64, 16, 32, 64, 16, Sm75>,
                                                            TensorOp<half_t, 16, 128, 16, 16, 128, 16, Sm75>,
                                                            TensorOp<half_t, 32, 128, 32, 16, 128, 16, Sm75>,
                                                            TensorOp<half_t, 16, 64, 32, 16, 32, 32, Sm75>,
                                                            TensorOp<half_t, 16, 64, 16, 16, 64, 16, Sm75>,
                                                            TensorOp<half_t, 16, 128, 32, 16, 128, 32, Sm75>,
                                                            TensorOp<half_t, 32, 64, 16, 16, 64, 16, Sm75>,
                                                            TensorOp<half_t, 32, 128, 32, 32, 64, 16, Sm75>,
                                                            TensorOp<half_t, 32, 64, 32, 16, 64, 16, Sm75>,
                                                            TensorOp<half_t, 32, 64, 32, 32, 64, 16, Sm75>,
                                                            TensorOp<half_t, 16, 64, 32, 8, 64, 32, Sm75>,
                                                            TensorOp<half_t, 32, 128, 16, 32, 64, 16, Sm75>,
                                                            TensorOp<half_t, 64, 64, 16, 16, 64, 16, Sm75>,
                                                            TensorOp<half_t, 64, 128, 32, 32, 64, 16, Sm75>,
                                                            TensorOp<half_t, 64, 128, 32, 16, 128, 32, Sm75>,
                                                            TensorOp<half_t, 32, 128, 32, 16, 128, 32, Sm75>,
                                                            TensorOp<half_t, 64, 128, 16, 64, 64, 16, Sm75>,
                                                            TensorOp<half_t, 32, 128, 32, 32, 64, 32, Sm75>,
                                                            TensorOp<half_t, 128, 64, 16, 32, 64, 16, Sm75>,
                                                            TensorOp<half_t, 16, 64, 32, 16, 64, 16, Sm75>,
                                                            TensorOp<half_t, 32, 64, 32, 16, 64, 32, Sm75>,
                                                            TensorOp<half_t, 128, 64, 32, 128, 64, 32, Sm75>,
                                                            TensorOp<half_t, 32, 64, 32, 32, 64, 32, Sm75>,
                                                            TensorOp<half_t, 64, 64, 16, 64, 32, 16, Sm75>,
                                                            TensorOp<half_t, 128, 128, 16, 16, 128, 16, Sm75>,
                                                            TensorOp<half_t, 64, 128, 32, 32, 64, 32, Sm75>,
                                                            TensorOp<half_t, 32, 128, 16, 32, 128, 16, Sm75>,
                                                            TensorOp<half_t, 64, 64, 32, 16, 32, 32, Sm75>,
                                                            TensorOp<half_t, 128, 64, 16, 128, 32, 16, Sm75>,
                                                            TensorOp<half_t, 64, 128, 16, 64, 128, 16, Sm75>,
                                                            TensorOp<half_t, 128, 128, 16, 32, 128, 16, Sm75>,
                                                            TensorOp<half_t, 128, 128, 32, 64, 64, 32, Sm75>,
                                                            TensorOp<half_t, 64, 64, 32, 32, 32, 32, Sm75>,
                                                            TensorOp<half_t, 32, 128, 32, 32, 128, 16, Sm75>,
                                                            TensorOp<half_t, 64, 128, 16, 16, 128, 16, Sm75>,
                                                            TensorOp<half_t, 128, 128, 32, 16, 64, 32, Sm75>,
                                                            TensorOp<half_t, 64, 128, 16, 32, 64, 16, Sm75>,
                                                            TensorOp<half_t, 64, 128, 32, 64, 32, 32, Sm75>,
                                                            TensorOp<half_t, 128, 128, 32, 32, 32, 32, Sm75>,
                                                            TensorOp<half_t, 64, 64, 32, 64, 32, 32, Sm75>,
                                                            TensorOp<half_t, 128, 128, 32, 128, 32, 32, Sm75>,
                                                            TensorOp<half_t, 64, 64, 32, 8, 64, 32, Sm75>,
                                                            TensorOp<half_t, 128, 128, 32, 8, 128, 32, Sm75>,
                                                            TensorOp<half_t, 64, 64, 16, 64, 64, 16, Sm75>,
                                                            TensorOp<half_t, 64, 64, 16, 32, 32, 16, Sm75>,
                                                            TensorOp<half_t, 64, 128, 32, 32, 128, 16, Sm75>,
                                                            TensorOp<half_t, 128, 64, 32, 32, 32, 32, Sm75>,
                                                            TensorOp<half_t, 128, 64, 16, 128, 64, 16, Sm75>,
                                                            TensorOp<half_t, 64, 128, 16, 32, 128, 16, Sm75>,
                                                            TensorOp<half_t, 64, 64, 32, 64, 64, 16, Sm75>,
                                                            TensorOp<half_t, 64, 128, 32, 8, 128, 32, Sm75>,
                                                            TensorOp<half_t, 128, 64, 32, 16, 64, 32, Sm75>,
                                                            TensorOp<half_t, 128, 128, 32, 64, 128, 16, Sm75>,
                                                            TensorOp<half_t, 64, 128, 32, 32, 128, 32, Sm75>,
                                                            TensorOp<half_t, 128, 128, 32, 16, 128, 16, Sm75>,
                                                            TensorOp<half_t, 64, 64, 32, 16, 64, 16, Sm75>,
                                                            TensorOp<half_t, 128, 128, 32, 32, 64, 16, Sm75>,
                                                            TensorOp<half_t, 64, 128, 32, 16, 64, 32, Sm75>,
                                                            TensorOp<half_t, 64, 64, 32, 64, 64, 32, Sm75>,
                                                            TensorOp<half_t, 128, 64, 16, 64, 32, 16, Sm75>,
                                                            TensorOp<half_t, 64, 64, 32, 32, 64, 16, Sm75>,
                                                            TensorOp<half_t, 64, 64, 16, 32, 64, 16, Sm75>,
                                                            TensorOp<half_t, 128, 64, 32, 64, 32, 32, Sm75>,
                                                            TensorOp<half_t, 128, 128, 32, 16, 128, 32, Sm75>,
                                                            TensorOp<half_t, 64, 64, 32, 16, 64, 32, Sm75>,
                                                            TensorOp<half_t, 64, 128, 32, 64, 64, 16, Sm75>,
                                                            TensorOp<half_t, 128, 128, 32, 128, 64, 16, Sm75>,
                                                            TensorOp<half_t, 128, 128, 32, 32, 64, 32, Sm75>,
                                                            TensorOp<half_t, 128, 64, 16, 64, 64, 16, Sm75>,
                                                            TensorOp<half_t, 128, 128, 32, 64, 128, 32, Sm75>,
                                                            TensorOp<half_t, 64, 64, 32, 32, 64, 32, Sm75>,
                                                            TensorOp<half_t, 128, 64, 32, 128, 32, 32, Sm75>,
                                                            TensorOp<half_t, 128, 128, 16, 128, 32, 16, Sm75>,
                                                            TensorOp<half_t, 64, 128, 32, 64, 64, 32, Sm75>,
                                                            TensorOp<half_t, 128, 128, 32, 128, 64, 32, Sm75>,
                                                            TensorOp<half_t, 64, 128, 32, 32, 32, 32, Sm75>,
                                                            TensorOp<half_t, 128, 64, 32, 64, 64, 16, Sm75>,
                                                            TensorOp<half_t, 64, 128, 32, 16, 128, 16, Sm75>,
                                                            TensorOp<half_t, 64, 128, 32, 64, 128, 16, Sm75>,
                                                            TensorOp<half_t, 128, 64, 32, 64, 64, 32, Sm75>,
                                                            TensorOp<half_t, 128, 128, 16, 64, 32, 16, Sm75>,
                                                            TensorOp<half_t, 128, 128, 32, 32, 128, 16, Sm75>,
                                                            TensorOp<half_t, 16, 128, 32, 16, 128, 32, Sm80>,
                                                            TensorOp<half_t, 64, 128, 16, 64, 32, 16, Sm75>,
                                                            TensorOp<half_t, 128, 128, 16, 32, 64, 16, Sm75>,
                                                            TensorOp<half_t, 128, 64, 32, 32, 64, 16, Sm75>,
                                                            TensorOp<half_t, 64, 128, 32, 64, 128, 32, Sm75>,
                                                            TensorOp<half_t, 128, 128, 32, 64, 32, 32, Sm75>,
                                                            TensorOp<half_t, 128, 128, 32, 32, 128, 32, Sm75>,
                                                            TensorOp<half_t, 32, 64, 32, 16, 32, 32, Sm80>,
                                                            TensorOp<half_t, 16, 64, 32, 16, 32, 32, Sm80>,
                                                            TensorOp<half_t, 128, 128, 16, 128, 64, 16, Sm75>,
                                                            TensorOp<half_t, 128, 64, 32, 32, 64, 32, Sm75>,
                                                            TensorOp<half_t, 128, 128, 16, 64, 64, 16, Sm75>,
                                                            TensorOp<half_t, 128, 128, 32, 128, 128, 16, Sm75>,
                                                            TensorOp<half_t, 32, 64, 32, 32, 32, 32, Sm80>,
                                                            TensorOp<half_t, 128, 64, 32, 128, 64, 16, Sm75>,
                                                            TensorOp<half_t, 64, 128, 32, 32, 128, 32, Sm80>,
                                                            TensorOp<half_t, 128, 128, 32, 64, 64, 16, Sm75>,
                                                            TensorOp<half_t, 128, 128, 32, 128, 128, 32, Sm75>,
                                                            TensorOp<half_t, 128, 128, 16, 128, 128, 16, Sm75>,
                                                            TensorOp<half_t, 128, 128, 16, 64, 128, 16, Sm75>,
                                                            TensorOp<half_t, 32, 64, 32, 16, 64, 32, Sm80>,
                                                            TensorOp<half_t, 16, 64, 32, 16, 64, 32, Sm80>,
                                                            TensorOp<half_t, 32, 64, 32, 32, 64, 32, Sm80>,
                                                            TensorOp<half_t, 32, 128, 32, 16, 64, 32, Sm80>,
                                                            TensorOp<half_t, 32, 128, 32, 32, 32, 32, Sm80>,
                                                            TensorOp<half_t, 64, 64, 32, 32, 32, 32, Sm80>,
                                                            TensorOp<half_t, 16, 128, 32, 16, 64, 32, Sm80>,
                                                            TensorOp<half_t, 32, 128, 32, 16, 128, 32, Sm80>,
                                                            TensorOp<half_t, 32, 128, 32, 32, 64, 32, Sm80>,
                                                            TensorOp<half_t, 64, 64, 32, 32, 64, 32, Sm80>,
                                                            TensorOp<half_t, 128, 64, 32, 32, 32, 32, Sm80>,
                                                            TensorOp<half_t, 64, 128, 32, 32, 32, 32, Sm80>,
                                                            TensorOp<half_t, 128, 128, 32, 64, 128, 32, Sm80>,
                                                            TensorOp<half_t, 64, 128, 32, 16, 64, 32, Sm80>,
                                                            TensorOp<half_t, 64, 64, 32, 16, 32, 32, Sm80>,
                                                            TensorOp<half_t, 64, 64, 32, 64, 32, 32, Sm80>,
                                                            TensorOp<half_t, 128, 128, 32, 128, 64, 32, Sm80>,
                                                            TensorOp<half_t, 32, 128, 32, 32, 128, 32, Sm80>,
                                                            TensorOp<half_t, 64, 128, 32, 64, 32, 32, Sm80>,
                                                            TensorOp<half_t, 128, 128, 32, 16, 64, 32, Sm80>,
                                                            TensorOp<half_t, 64, 128, 32, 64, 64, 32, Sm80>,
                                                            TensorOp<half_t, 128, 64, 32, 32, 64, 32, Sm80>,
                                                            TensorOp<half_t, 64, 128, 32, 32, 64, 32, Sm80>,
                                                            TensorOp<half_t, 64, 128, 32, 16, 128, 32, Sm80>,
                                                            TensorOp<half_t, 64, 64, 32, 16, 64, 32, Sm80>,
                                                            TensorOp<half_t, 128, 64, 32, 128, 32, 32, Sm80>,
                                                            TensorOp<half_t, 64, 64, 32, 64, 64, 32, Sm80>,
                                                            TensorOp<half_t, 128, 128, 32, 128, 128, 32, Sm80>,
                                                            TensorOp<half_t, 128, 128, 32, 16, 128, 32, Sm80>,
                                                            TensorOp<half_t, 64, 128, 32, 64, 128, 32, Sm80>,
                                                            TensorOp<half_t, 128, 128, 32, 32, 32, 32, Sm80>,
                                                            TensorOp<half_t, 128, 64, 32, 128, 64, 32, Sm80>,
                                                            TensorOp<half_t, 128, 64, 32, 16, 64, 32, Sm80>,
                                                            TensorOp<half_t, 128, 128, 32, 32, 64, 32, Sm80>,
                                                            TensorOp<half_t, 128, 128, 32, 128, 32, 32, Sm80>,
                                                            TensorOp<half_t, 128, 64, 32, 64, 32, 32, Sm80>,
                                                            TensorOp<half_t, 128, 128, 32, 64, 32, 32, Sm80>,
                                                            TensorOp<half_t, 128, 128, 32, 32, 128, 32, Sm80>,
                                                            TensorOp<half_t, 128, 64, 32, 64, 64, 32, Sm80>,
                                                            TensorOp<half_t, 128, 128, 32, 64, 64, 32, Sm80>>;
}  // namespace func
}  // namespace spconv